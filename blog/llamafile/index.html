<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Llamafile</title>
        <meta name="description" content="An explanation of llamafile, a file type that lets you run LLMs from a single file" />
        <link rel="canonical" href="https://colourlessspearmint.github.io/blog/llamafile/" />
        <meta property="og:title" content="Llamafile" />
        <meta property="og:description" content="An explanation of llamafile, a file type that lets you run LLMs from a single file" />
        <meta property="og:type" content="article" />
        <meta property="og:url" content="https://colourlessspearmint.github.io/blog/llamafile/" />
        <link rel="stylesheet" href="/common.css" />
        
        <link rel="stylesheet" href="/static/codehilite.css" />
        
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&family=Sen:wght@400..800&display=swap"
            rel="stylesheet"
        />
        <link rel="icon" href="/favicon.ico" type="image/x-icon" />
        <script src="/common.js"></script>
    </head>
    <body>
        <ethan-header></ethan-header>
        <main>
            <h1 class="animated">Llamafile</h1>
            <time class="animated" datetime="2025-06-24">June 24, 2025</time>
            
            <div class="post-tags">
                
                <a class="post-tag animated" href="/tag/curios"
                    >#curios</a
                >  
                <a class="post-tag animated" href="/tag/programming"
                    >#programming</a
                >  
                <a class="post-tag animated" href="/tag/ai"
                    >#ai</a
                > 
            </div>
            
            <div class="external-link-row">
                <a class="external-link" href="github.com/Mozilla-Ocho/llamafile">
                    <img
                        src="/media/icons/github.svg"
                        alt="github icon"
                    />
                    <span
                        >GitHub Repo</span
                    >
                </a>
            </div>
            
            <article class="animated"><figure><img alt="llamafile banner" src="https://cdn-uploads.huggingface.co/production/uploads/64a523ba1ed90082dafde3d3/kJrkxofwOp-89uYFe0EBb.png" /></figure>
<p>Last week, I stumbled upon <a href="https://github.com/Mozilla-Ocho/llamafile" target="_blank">llamafile</a>. It's a file format developed by <a href="https://www.mozilla.org/en-US/" target="_blank">Mozilla</a> that stores the weights and code of <a href="https://en.wikipedia.org/wiki/Large_language_model" target="_blank">LLMs</a> as pre-compiled <a href="https://en.wikipedia.org/wiki/Binary_code" target="_blank">binary machine code</a>. What this means is that you can run a llamafile on <em>any</em> computer without installing <em>anything</em> else.</p>
<p>Actually, I need to qualify the "run on any computer" statement a bit. Llamafiles can run on any computer running <a href="https://en.wikipedia.org/wiki/Microsoft_Windows" target="_blank">Windows</a>, <a href="https://en.wikipedia.org/wiki/MacOS" target="_blank">MacOS</a>, <a href="https://en.wikipedia.org/wiki/Linux" target="_blank">Linux</a>, <a href="https://en.wikipedia.org/wiki/FreeBSD" target="_blank">FreeBSD</a>, <a href="https://en.wikipedia.org/wiki/NetBSD" target="_blank">NetBSD</a>, or <a href="https://en.wikipedia.org/wiki/OpenBSD" target="_blank">OpenBSD</a>. The computer needs to have a <a href="https://en.wikipedia.org/wiki/AMD" target="_blank">64-bit AMD processor</a>, an <a href="https://en.wikipedia.org/wiki/List_of_Intel_processors" target="_blank">Intel processor newer than 2006</a>, a <a href="https://en.wikipedia.org/wiki/ARM_architecture_family" target="_blank">64-bit ARM processor</a>, or an <a href="https://en.wikipedia.org/wiki/Apple_silicon" target="_blank">Apple Silicon</a> processor. You'll also need a non-trivial amount of RAM: 4 gigabtyes at minimum. These requirements are very lax, and your computer probably meets those specifications if it was manufactured less than a decade ago.</p>
<figure><video class="video" src="/media/llamafile_demo.webm" controls alt="A video demonstration of the Gemma 3 llamafile running on the Nvidia 1650 in my Windows 11 laptop. It runs at 34.46 tokens per second, and gives complete answers including bullet points and comparison tables"></video></figure>
<p>I <em>don't</em> need to qualify the "without installing anything" statement, though. You really can just download a llamafile and run it. Above is a demonstration with a freshly-downloaded llamafile of a <a href="https://developers.google.com/machine-learning/glossary#distillation" target="_blank">distilled</a> and <a href="https://developers.google.com/machine-learning/glossary#quantization" target="_blank">quantized</a> version of <a href="https://deepmind.google/models/gemma/gemma-3/" target="_blank">Google Gemma 3</a> running on my Windows 11 laptop.</p>
<p>If you want to try it yourself, you can read the <a href="https://github.com/Mozilla-Ocho/llamafile?tab=readme-ov-file#quickstart" target="_blank">official usage guide</a> or follow the my Windows-specific steps below.</p>
<ol>
<li>Download the llamafile: <a href="https://huggingface.co/Mozilla/gemma-3-1b-it-llamafile/resolve/main/google_gemma-3-1b-it-Q6_K.llamafile?download=true" target="_blank">google_gemma-3-1b-it-Q6_K.llamafile</a></li>
<li>Rename the file to add ".exe" to the end (this makes the llamafile runnable on Windows)</li>
<li>Run the llamafile by double-clicking</li>
<li>Allow it past your antivirus; as long as you acquired the llamafile from a reputable source, it should be safe</li>
<li>Type a message in the terminal window that opens up</li>
<li>Wait for the LLM to respond</li>
</ol>
<p>As you can see, it gives complete, coherent answers. You can run any <a href="https://github.com/Open-Weights/Definition" target="_blank">open-weight</a> LLM, including <a href="https://huggingface.co/deepseek-ai/DeepSeek-R1" target="_blank">Deepseek R1</a>, provided you have enough computing power (700 gigabytes of RAM, in the case of Deepseek), but tiny models (like the Gemma model I'm using) also exist that can run on basically anything. They aren't very smart (because the distillation and quantization process is basically an AI <a href="https://en.wikipedia.org/wiki/Lobotomy" target="_blank">lobotomy</a>), so they'll make even more mistakes than normal LLMs.</p>
<p>The useful part of llamafiles is that they run completely locally: all processing happens on <em>your</em> computer. This means that it's completely free (minus the electricity to run your computer) and isn't dependent on some data center in Silicon Valley. No matter what happens to the outside world, as long as your computer still has power, you will be able to run a llamafile. You can turn on airplane mode, physically remove the antenna module, put it in a faraday cage, and shut down the World Wide Web, and a llamafile will still work.</p>
<h2>Example Use Case</h2>
<p>If you have a menial task that requires the adaptability and language understanding of an LLM but doesn't necessitate the intelligence of a powerful one, you can use tiny llamafiles like the lobotomized Gemma model I demoed earlier. For example, inspired by <a href="https://til.simonwillison.net/llms/claude-hacker-news-themes" target="_blank">this Simon Willison blog post</a>, I threw together a PowerShell script that fetches <a href="https://news.ycombinator.com/" target="_blank">HN</a> article comments and feeds them to a llamafile for summarization.</p>
<div class="codehilite"><pre><span></span><code><span class="c"># This script fetches a Hacker News article, processes it,</span>
<span class="c"># and then uses a llamafile to summarize the comments.</span>

<span class="k">param</span><span class="p">(</span>
    <span class="c"># Defines a mandatory string parameter named StoryId.</span>
    <span class="c"># This parameter will hold the Hacker News story ID.</span>
    <span class="p">[</span><span class="k">Parameter</span><span class="p">(</span><span class="k">Mandatory</span><span class="p">=</span><span class="nv">$true</span><span class="p">)]</span>
    <span class="no">[string]</span><span class="nv">$StoryId</span>
<span class="p">)</span>

<span class="c"># Specifies the full path to the llamafile executable.</span>
<span class="nv">$llamafile</span> <span class="p">=</span> <span class="s2">&quot;C:\Users\ethan\source\llamafile\google_gemma-3-1b-it-Q6_K.llamafile.exe&quot;</span>

<span class="c"># Defines a recursive function to extract all &#39;text&#39; properties from a</span>
<span class="c"># hierarchical structure of Hacker News comments.</span>
<span class="c"># HN comments can have nested &#39;children&#39; (replies), so recursion is needed</span>
<span class="c"># to traverse the entire comment tree.</span>
<span class="k">function</span> <span class="nb">Get-HnCommentText</span><span class="p">(</span><span class="nv">$comments</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$comment</span> <span class="k">in</span> <span class="nv">$comments</span><span class="p">)</span> <span class="p">{</span>
        <span class="c"># If the current comment object has a &#39;text&#39; property and it&#39;s not null,</span>
        <span class="c"># output its value. This will be collected by the calling expression.</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$null</span> <span class="o">-ne</span> <span class="nv">$comment</span><span class="p">.</span><span class="n">text</span><span class="p">)</span> <span class="p">{</span> 
            <span class="nv">$comment</span><span class="p">.</span><span class="n">text</span> 
        <span class="p">}</span>

        <span class="c"># If the current comment object has children (replies),</span>
        <span class="c"># recursively call this function extract their text.</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$null</span> <span class="o">-ne</span> <span class="nv">$comment</span><span class="p">.</span><span class="n">children</span><span class="p">)</span> <span class="p">{</span> 
            <span class="nb">Get-HnCommentText</span> <span class="n">-comments</span> <span class="nv">$comment</span><span class="p">.</span><span class="n">children</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c"># Retrieve all comments for the Hacker News story with a REST method.</span>
<span class="nv">$commentText</span> <span class="p">=</span> <span class="nb">Get-HnCommentText</span> <span class="p">(</span><span class="nb">Invoke-RestMethod</span> <span class="p">`</span>
    <span class="s2">&quot;https://hn.algolia.com/api/v1/items/$StoryId&quot;</span><span class="p">).</span><span class="n">children</span> <span class="p">|</span> <span class="nb">Out-String</span>

<span class="c"># Constructs the prompt string for the AI model using a here-string.</span>
<span class="nv">$prompt</span> <span class="p">=</span> <span class="sh">@&quot;</span>
<span class="sh">$commentText</span>

<span class="sh">Summarize the themes of the opinions expressed here, including direct quotes.</span>
<span class="sh">&quot;@</span>

<span class="c"># Executes the llamafile.</span>
<span class="c"># The &#39;&amp;&#39; operator is used to run an executable stored in a variable.</span>
<span class="c"># &#39;-p $prompt&#39; passes the constructed prompt string to the llamafile executable</span>
<span class="p">&amp;</span> <span class="nv">$llamafile</span> <span class="n">-p</span> <span class="nv">$prompt</span>
</code></pre></div>

<h2>Advantages</h2>
<h3>Offline Usage</h3>
<p>Llamafiles provide access to an LLM when you don't have internet. For example, if you're driving to a national park on a completely empty nothing-for-kilometers-in-every-direction stretch of road without any cell service, you can just prompt a llamafile if you have a question.</p>
<h3>Data Privacy</h3>
<p>Llamafiles can process sensitive data without it leaving your device. Maybe you don't want OpenAI to have access to your medical records, but also can't be bothered to read them yourself. Feed the PDFs to a llamafile and ask it to search for anything important.</p>
<h3>Archiving</h3>
<p>Llamafiles provide a way to archive LLMs in case they stop being hosted. Imagine, for a moment, that a leading AI provider releases a model with state-of-the-art performance that everyone loves, and then they suddenly decide to stop hosting it for reasons they refuse to elaborate on. I can't think of any time this has happened before (this is sarcasm; I'm still bitter about <a href="https://discuss.ai.google.dev/t/urgent-feedback-call-for-correction-a-serious-breach-of-developer-trust-and-stability-update-google-formally-responds-8-days-later/82399" target="_blank">Gemini 03-25</a>), but it's conceivable that you might want to archive an LLM in such a way that it can never be taken away. Llamafiles are a great way to do that (provided the model is open-weight; otherwise you're just out of luck).</p>
<h3>Small Environmental Impact</h3>
<p>One of the main concerns around the AI boom is the resource consumption of all the computing power used for AI training and inference. Over the past few years, AI inference has gotten cheaper and less computationally demanding due to efficient custom TPUs. However, as models grow ever larger and use ever more training data, AI training has gotten exponentially more expensive. The precise impact of hosted LLMs is difficult to measure, but it's definitely not insignificant. On the contrary, running a llamafile consume only slightly more electricity than your computer does during normal operation. If you've read this far, loading and rendering this webpage almost certainly used more electricity than generating a few hundred tokens with a tiny llamafile.</p>
<h2>Disadvantages</h2>
<h3>Lobotomy make LLM not work good</h3>
<p>Any llamafile that can run on consumer hardware is going to be really stupid. There are some impressively intelligent yet compact llamafiles (<a href="https://qwen.ai/" target="_blank">Qwen</a> distills are usually pretty good), but they still won't be able to even approach the intelligence of full hosted models. There's a reason my HN summarizer prompts the llamafile to use quotes: otherwise it'll just make stuff up. It's always good practice to double-check claims made by LLMs, but I cannot emphasize enough how important fact checking is for distilled and quantized models. It <em>will</em> make things up.</p>
<h3>Slow Generation Speed</h3>
<p>Hosted LLMs are capable of generating at truly ridiculous speeds that consumer llamafiles can't possibly match, no matter how much we distill and quantize it it. The Gemma model from my demonstration runs at 30-40 tokens per second on my Nvidia 1650, which is still quite fast, but is much slower than a hosted LLM.</p>
<h2>Llamafile vs Ollama</h2>
<p>Llamafiles aren't the only way to run LLMs locally. <a href="https://ollama.com/" target="_blank">Ollama</a>, <a href="https://github.com/ggml-org/llama.cpp" target="_blank">llama.cpp</a>, <a href="https://lmstudio.ai/" target="_blank">LM studio</a>, <a href="https://ai.google.dev/edge" target="_blank">Google AI Edge Gallery</a>, and many others all serve similar functions. What makes llamafiles special is the zero-installation gimmick. Having to install things puts people off of running LLMs locally. A llamafile can be run without any setup, which makes it far more accessible to people who don't have time to configure <a href="https://en.wikipedia.org/wiki/CUDA" target="_blank">CUDA</a> and just want a self-hosted chatbot.</p>
<h2>Conclusion</h2>
<p>Recently, a few large tech companies have expressed an interest in tiny locally-hosted LLMs. Google released <a href="https://ai.google.dev/edge" target="_blank">AI Edge Gallery</a>, and Apple released <a href="https://developer.apple.com/documentation/foundationmodels" target="_blank">Foundation Models</a>. Both of these use tiny LLMs optimized for running on mobile processors. I'm just speculating here, but this might be an indicator that Google and Apple are starting to get sick of having to host AI inference for all of their AI-powered products and are trying to foist the computation onto consumer devices by making their models open-weight. This sounds like a mutually beneficial arrangement to me, and it's convenient that we already have a file format for storing LLMs in a single file: llamafile.</p>
<p>Thanks for reading!</p>
<p>~Ethan</p></article>
        </main>
        <ethan-footer></ethan-footer>
    </body>
</html>